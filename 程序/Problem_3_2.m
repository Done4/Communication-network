clear
clc
load('Problem_3_1.mat');
%返回参数列表%返回参数 维度难处理成object,无法用循环解决
%被炸节点集合索引，按分布顺序
reserveListIndex=[cityListIndex1,cityListIndex2];

RR=max(max(c(reserveListIndex(1),find(c(reserveListIndex(1),:)))),max(c(find(c(:,reserveListIndex(1))),reserveListIndex(1))));
connIndexP3=[find(c(:,reserveListIndex(1))),find(c(reserveListIndex(1),:))];
coLngP3=lng(connIndexP3);
coLatP3=lat(connIndexP3);
[reserveListAlterIndex1,reserveList11,reserveList12,reserveList13]=Alterna(lng(reserveListIndex(1)),lat(reserveListIndex(1)),insLng,insLat,RR,coLngP3,coLatP3);
%
RR=max(max(c(reserveListIndex(2),find(c(reserveListIndex(2),:)))),max(c(find(c(:,reserveListIndex(2))),reserveListIndex(2))));
connIndexP3=[find(c(:,reserveListIndex(2))),find(c(reserveListIndex(2),:))];
coLngP3=lng(connIndexP3);
coLatP3=lat(connIndexP3);
[reserveListAlterIndex2,reserveList21,reserveList22,reserveList23]=Alterna(lng(reserveListIndex(2)),lat(reserveListIndex(2)),insLng,insLat,RR,coLngP3,coLatP3);
%
RR=max(max(c(reserveListIndex(3),find(c(reserveListIndex(3),:)))),max(c(find(c(:,reserveListIndex(3))),reserveListIndex(3))));
connIndexP3=[find(c(:,reserveListIndex(3))),find(c(reserveListIndex(3),:))];
coLngP3=lng(connIndexP3);
coLatP3=lat(connIndexP3);
[reserveListAlterIndex3,reserveList31,reserveList32,reserveList33]=Alterna(lng(reserveListIndex(3)),lat(reserveListIndex(3)),insLng,insLat,RR,coLngP3,coLatP3);
%
RR=115.4634;%特殊点
connIndexP3=[find(c(:,reserveListIndex(4))),find(c(reserveListIndex(4),:))];
coLngP3=lng(connIndexP3);
coLatP3=lat(connIndexP3);
[reserveListAlterIndex4,reserveList41,reserveList42,reserveList43]=Alterna(lng(reserveListIndex(4)),lat(reserveListIndex(4)),insLng,insLat,RR,coLngP3,coLatP3);
%
RR=max(max(c(reserveListIndex(5),find(c(reserveListIndex(5),:)))),max(c(find(c(:,reserveListIndex(5))),reserveListIndex(5))));
connIndexP3=[find(c(:,reserveListIndex(5))),find(c(reserveListIndex(5),:))];
coLngP3=lng(connIndexP3);
coLatP3=lat(connIndexP3);
[reserveListAlterIndex5,reserveList51,reserveList52,reserveList53]=Alterna(lng(reserveListIndex(5)),lat(reserveListIndex(5)),insLng,insLat,RR,coLngP3,coLatP3);
%
RR=max(max(c(reserveListIndex(6),find(c(reserveListIndex(6),:)))),max(c(find(c(:,reserveListIndex(6))),reserveListIndex(6))));
connIndexP3=[find(c(:,reserveListIndex(6))),find(c(reserveListIndex(6),:))];
coLngP3=lng(connIndexP3);
coLatP3=lat(connIndexP3);
[reserveListAlterIndex6,reserveList61,reserveList62,reserveList63]=Alterna(lng(reserveListIndex(6)),lat(reserveListIndex(6)),insLng,insLat,RR,coLngP3,coLatP3);
%
RR=max(max(c(reserveListIndex(7),find(c(reserveListIndex(7),:)))),max(c(find(c(:,reserveListIndex(7))),reserveListIndex(7))));
connIndexP3=[find(c(:,reserveListIndex(7))),find(c(reserveListIndex(7),:))];
coLngP3=lng(connIndexP3);
coLatP3=lat(connIndexP3);
[reserveListAlterIndex7,reserveList71,reserveList72,reserveList73]=Alterna(lng(reserveListIndex(7)),lat(reserveListIndex(7)),insLng,insLat,RR,coLngP3,coLatP3);
%
RR=max(max(c(reserveListIndex(8),find(c(reserveListIndex(8),:)))),max(c(find(c(:,reserveListIndex(8))),reserveListIndex(8))));
connIndexP3=[find(c(:,reserveListIndex(8))),find(c(reserveListIndex(8),:))];
coLngP3=lng(connIndexP3);
coLatP3=lat(connIndexP3);
[reserveListAlterIndex8,reserveList81,reserveList82,reserveList83]=Alterna(lng(reserveListIndex(8)),lat(reserveListIndex(8)),insLng,insLat,RR,coLngP3,coLatP3);
%
RR=max(max(c(reserveListIndex(9),find(c(reserveListIndex(9),:)))),max(c(find(c(:,reserveListIndex(9))),reserveListIndex(9))));
connIndexP3=[find(c(:,reserveListIndex(9))),find(c(reserveListIndex(9),:))];
coLngP3=lng(connIndexP3);
coLatP3=lat(connIndexP3);
[reserveListAlterIndex9,reserveList91,reserveList92,reserveList93]=Alterna(lng(reserveListIndex(9)),lat(reserveListIndex(9)),insLng,insLat,RR,coLngP3,coLatP3);
   
%画图
figure;
scatter(pThrMatCo(1:9,1),pThrMatCo(1:9,2),'k','*');%被炸点
hold;
scatter([coLng1;coLng2],[coLat1;coLat2],'b');%连接点
scatter([reserveList11(1),reserveList21(1),reserveList31(1),reserveList41(1),reserveList51(1),reserveList61(1),reserveList71(1),reserveList81(1),reserveList91(1)],[reserveList11(2),reserveList21(2),reserveList31(2),reserveList41(2),reserveList51(2),reserveList61(2),reserveList71(2),reserveList81(2),reserveList91(2)],'r');
%不改索引的情况下 直接连接
line([lng(61),lng(67)],[lat(61),lat(67)],'color','b');
line([lng(67),reserveList31(1)],[lat(67),reserveList31(2)],'color','r');
line([reserveList11(1),reserveList31(1)],[reserveList11(2),reserveList31(2)],'color','r');
line([reserveList11(1),reserveList21(1)],[reserveList11(2),reserveList21(2)],'color','r');
line([reserveList51(1),reserveList21(1)],[reserveList51(2),reserveList21(2)],'color','r');
line([reserveList51(1),reserveList61(1)],[reserveList51(2),reserveList61(2)],'color','r');
line([reserveList51(1),reserveList41(1)],[reserveList51(2),reserveList41(2)],'color','r');
line([reserveList51(1),lng(42)],[reserveList51(2),lat(42)],'color','r');
line([reserveList61(1),lng(60)],[reserveList61(2),lat(60)],'color','r');
%下一部分
line([reserveList91(1),lng(61)],[reserveList91(2),lat(61)],'color','r');
line([reserveList91(1),reserveList81(1)],[reserveList91(2),reserveList81(2)],'color','r');
line([reserveList71(1),reserveList81(1)],[reserveList71(2),reserveList81(2)],'color','r');
line([reserveList71(1),lng(39)],[reserveList71(2),lat(39)],'color','r');
line([reserveList71(1),lng(34)],[reserveList71(2),lat(34)],'color','r');
text([lng(pThrMatIndex);reserveList11(1);reserveList21(1);reserveList31(1);reserveList41(1);reserveList51(1);reserveList61(1);reserveList71(1);reserveList81(1);reserveList91(1)],[lat(pThrMatIndex);reserveList11(2);reserveList21(2);reserveList31(2);reserveList41(2);reserveList51(2);reserveList61(2);reserveList71(2);reserveList81(2);reserveList91(2)],[cityName(pThrMatIndex);insCityName(reserveList11(3));insCityName(reserveList21(3));insCityName(reserveList31(3));insCityName(reserveList41(3));insCityName(reserveList51(3));insCityName(reserveList61(3));insCityName(reserveList71(3));insCityName(reserveList81(3));insCityName(reserveList91(3))],'fontsize',8,'fontweight','bold');
hold off;
xlabel('经度');
ylabel('纬度');

%
figure;
scatter(pThrMatCo(1:9,1),pThrMatCo(1:9,2),'k','*');%被炸点
hold;
scatter([coLng1;coLng2],[coLat1;coLat2],'b');%连接点
scatter([reserveList12(1),reserveList22(1),reserveList32(1),reserveList42(1),reserveList52(1),reserveList62(1),reserveList72(1),reserveList82(1),reserveList92(1)],[reserveList12(2),reserveList22(2),reserveList32(2),reserveList42(2),reserveList52(2),reserveList62(2),reserveList72(2),reserveList82(2),reserveList92(2)],'r');
%不改索引的情况下 直接连接
line([lng(61),lng(67)],[lat(61),lat(67)],'color','b');
line([lng(67),reserveList32(1)],[lat(67),reserveList32(2)],'color','r');
line([reserveList12(1),reserveList32(1)],[reserveList12(2),reserveList32(2)],'color','r');
line([reserveList12(1),reserveList22(1)],[reserveList12(2),reserveList22(2)],'color','r');
line([reserveList52(1),reserveList22(1)],[reserveList52(2),reserveList22(2)],'color','r');
line([reserveList52(1),reserveList62(1)],[reserveList52(2),reserveList62(2)],'color','r');
line([reserveList52(1),reserveList42(1)],[reserveList52(2),reserveList42(2)],'color','r');
line([reserveList52(1),lng(42)],[reserveList52(2),lat(42)],'color','r');
line([reserveList62(1),lng(60)],[reserveList62(2),lat(60)],'color','r');
%下一部分
line([reserveList92(1),lng(61)],[reserveList92(2),lat(61)],'color','r');
line([reserveList92(1),reserveList82(1)],[reserveList92(2),reserveList82(2)],'color','r');
line([reserveList72(1),reserveList82(1)],[reserveList72(2),reserveList82(2)],'color','r');
line([reserveList72(1),lng(39)],[reserveList72(2),lat(39)],'color','r');
line([reserveList72(1),lng(34)],[reserveList72(2),lat(34)],'color','r');
text([lng(pThrMatIndex);reserveList12(1);reserveList22(1);reserveList32(1);reserveList42(1);reserveList52(1);reserveList62(1);reserveList72(1);reserveList82(1);reserveList92(1)],[lat(pThrMatIndex);reserveList12(2);reserveList22(2);reserveList32(2);reserveList42(2);reserveList52(2);reserveList62(2);reserveList72(2);reserveList82(2);reserveList92(2)],[cityName(pThrMatIndex);insCityName(reserveList12(3));insCityName(reserveList22(3));insCityName(reserveList32(3));insCityName(reserveList42(3));insCityName(reserveList52(3));insCityName(reserveList62(3));insCityName(reserveList72(3));insCityName(reserveList82(3));insCityName(reserveList92(3))],'fontsize',8,'fontweight','bold');
hold off;
xlabel('经度');
ylabel('纬度');

%
figure;
scatter(pThrMatCo(1:9,1),pThrMatCo(1:9,2),'k','*');%被炸点
hold;
scatter([coLng1;coLng2],[coLat1;coLat2],'b');%连接点
scatter([reserveList13(1),reserveList23(1),reserveList33(1),reserveList43(1),reserveList53(1),reserveList63(1),reserveList73(1),reserveList83(1),reserveList93(1)],[reserveList13(2),reserveList23(2),reserveList33(2),reserveList43(2),reserveList53(2),reserveList63(2),reserveList73(2),reserveList83(2),reserveList93(2)],'r');
%不改索引的情况下 直接连接
line([lng(61),lng(67)],[lat(61),lat(67)],'color','b');
line([lng(67),reserveList33(1)],[lat(67),reserveList33(2)],'color','r');
line([reserveList13(1),reserveList33(1)],[reserveList13(2),reserveList33(2)],'color','r');
line([reserveList13(1),reserveList23(1)],[reserveList13(2),reserveList23(2)],'color','r');
line([reserveList53(1),reserveList23(1)],[reserveList53(2),reserveList23(2)],'color','r');
line([reserveList53(1),reserveList63(1)],[reserveList53(2),reserveList63(2)],'color','r');
line([reserveList53(1),reserveList43(1)],[reserveList53(2),reserveList43(2)],'color','r');
line([reserveList53(1),lng(42)],[reserveList53(2),lat(42)],'color','r');
line([reserveList63(1),lng(60)],[reserveList63(2),lat(60)],'color','r');
%下一部分
line([reserveList93(1),lng(61)],[reserveList93(2),lat(61)],'color','r');
line([reserveList93(1),reserveList83(1)],[reserveList93(2),reserveList83(2)],'color','r');
line([reserveList73(1),reserveList83(1)],[reserveList73(2),reserveList83(2)],'color','r');
line([reserveList73(1),lng(39)],[reserveList73(2),lat(39)],'color','r');
line([reserveList73(1),lng(34)],[reserveList73(2),lat(34)],'color','r');
text([lng(pThrMatIndex);reserveList13(1);reserveList23(1);reserveList33(1);reserveList43(1);reserveList53(1);reserveList63(1);reserveList73(1);reserveList83(1);reserveList93(1)],[lat(pThrMatIndex);reserveList13(2);reserveList23(2);reserveList33(2);reserveList43(2);reserveList53(2);reserveList63(2);reserveList73(2);reserveList83(2);reserveList93(2)],[cityName(pThrMatIndex);insCityName(reserveList13(3));insCityName(reserveList23(3));insCityName(reserveList33(3));insCityName(reserveList43(3));insCityName(reserveList53(3));insCityName(reserveList63(3));insCityName(reserveList73(3));insCityName(reserveList83(3));insCityName(reserveList93(3))],'fontsize',8,'fontweight','bold');
hold off;
xlabel('经度');
ylabel('纬度');

    